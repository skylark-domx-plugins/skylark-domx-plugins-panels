{"version":3,"sources":["Toolbar.js"],"names":["define","langx","$","plugins","panels","Toolbar","Plugin","inherit","klassName","pluginName","options","toolbarFloat","toolbarHidden","toolbarFloatOffset","template","separator","_construct","elm","toolbarHeight","_this","this","overrided","_velm","elmx","opts","wrapper","_elm","list","find","on","e","removeClass","document","css","width","editor","editable","util","reflow","outerWidth","os","mobile","position","left","offset","outerHeight","placeholderEl","addToolItem","itemWidget","appendTo","addSeparator","register"],"mappings":";;;;;;;AAAAA,QACE,sBACA,qBACA,uBACA,YACA,SAASC,EAAMC,EAAEC,EAAQC,GAGzB,IAAIC,EAAUF,EAAQG,OAAOC,SAC3BC,UAAY,UAEZC,WAAa,sBAEbC,SACEC,cAAc,EACdC,eAAe,EACfC,mBAAoB,EACpBC,SAAW,4CACXC,WACED,SAAY,6CAIhBE,WAAa,SAASC,EAAIP,GAIxB,IAAwCQ,EAgBDC,EAnBvCC,KAAKC,UAAUJ,EAAIP,GACnBU,KAAKE,MAAQF,KAAKG,OAMlBH,KAAKI,KAAOJ,KAAKV,QAOjBU,KAAKK,QAAUvB,EAAEkB,KAAKM,MACtBN,KAAKO,KAAOP,KAAKK,QAAQG,KAAK,MAC9BR,KAAKO,KAAKE,GAAG,QAAS,SAASC,GAC7B,OAAO,IAETV,KAAKK,QAAQI,GAAG,aAAuBV,EAIpCC,KAHM,SAASU,GACd,OAAOX,EAAMQ,KAAKC,KAAK,YAAYG,YAAY,eAGnD7B,EAAE8B,UAAUH,GAAG,oBAAqB,SAAUV,GAC5C,OAAO,SAASW,GACd,OAAOX,EAAMQ,KAAKC,KAAK,YAAYG,YAAY,YAFf,CAIjCX,QACEA,KAAKI,KAAKZ,eAAiBQ,KAAKI,KAAKb,eACxCS,KAAKK,QAAQQ,IAAI,MAAOb,KAAKI,KAAKX,oBAClCK,EAAgB,EACG,SAAUC,GAC3B,OAAO,WASL,OARAA,EAAMM,QAAQQ,IAAI,WAAY,UAC9Bd,EAAMM,QAAQS,MAAM,QACpBf,EAAMgB,OAAOC,SAASC,KAAKC,OAAOnB,EAAMM,SACxCN,EAAMM,QAAQS,MAAMf,EAAMM,QAAQc,cAClCpB,EAAMM,QAAQQ,IAAI,OAAQd,EAAMgB,OAAOC,SAASC,KAAKG,GAAGC,OAAStB,EAAMM,QAAQiB,WAAWC,KAAOxB,EAAMM,QAAQmB,SAASD,MACxHxB,EAAMM,QAAQQ,IAAI,WAAY,IAC9Bf,EAAgBC,EAAMM,QAAQoB,cAC9B1B,EAAMgB,OAAOW,cAAcb,IAAI,MAAOf,IAC/B,GAVQ,CAYhBE,QA4CP2B,YAAc,SAASC,GAErB,OADA9C,EAAE8C,EAAWtB,MAAMuB,SAAS7B,KAAKO,MAC1BP,MAGT8B,aAAe,WAEb,OADAhD,EAAEkB,KAAKV,QAAQK,UAAUD,UAAUmC,SAAS7B,KAAKO,MAC1CP,QAOX,OAFAjB,EAAQgD,SAAS9C,GAEVD,EAAOC,QAAUA","file":"../Toolbar.js","sourcesContent":["define([\n  \"skylark-langx/langx\",\n  \"skylark-domx-query\",\n  \"skylark-domx-plugins\",\n  \"./panels\"\n],function(langx,$,plugins,panels){ \n\n\n  var Toolbar = plugins.Plugin.inherit({\n    klassName : \"Toolbar\",\n\n    pluginName : \"domx.panels.toolbar\",\n\n    options : {\n      toolbarFloat: true,\n      toolbarHidden: false,\n      toolbarFloatOffset: 0,\n      template : '<div class=\"domx-toolbar\"><ul></ul></div>',\n      separator : {\n        template :  '<li><span class=\"separator\"></span></li>'\n      }\n    },\n\n    _construct : function(elm,options) {\n      this.overrided(elm,options);\n      this._velm = this.elmx();\n\n      var floatInitialized, initToolbarFloat, toolbarHeight;\n      //this.editor = editor;\n\n      //this.opts = langx.extend({}, this.opts, opts);\n      this.opts = this.options;\n\n\n      //if (!langx.isArray(this.opts.toolbar)) {\n      //  this.opts.toolbar = ['bold', 'italic', 'underline', 'strikethrough', '|', 'ol', 'ul', 'blockquote', 'code', '|', 'link', 'image', '|', 'indent', 'outdent'];\n      //}\n\n      this.wrapper = $(this._elm);\n      this.list = this.wrapper.find('ul');\n      this.list.on('click', function(e) {\n        return false;\n      });\n      this.wrapper.on('mousedown', (function(_this) {\n        return function(e) {\n          return _this.list.find('.menu-on').removeClass('.menu-on');\n        };\n      })(this));\n      $(document).on('mousedown.toolbar', (function(_this) {\n        return function(e) {\n          return _this.list.find('.menu-on').removeClass('menu-on');\n        };\n      })(this));\n      if (!this.opts.toolbarHidden && this.opts.toolbarFloat) {\n        this.wrapper.css('top', this.opts.toolbarFloatOffset);\n        toolbarHeight = 0;\n        initToolbarFloat = (function(_this) {\n          return function() {\n            _this.wrapper.css('position', 'static');\n            _this.wrapper.width('auto');\n            _this.editor.editable.util.reflow(_this.wrapper);\n            _this.wrapper.width(_this.wrapper.outerWidth());\n            _this.wrapper.css('left', _this.editor.editable.util.os.mobile ? _this.wrapper.position().left : _this.wrapper.offset().left);\n            _this.wrapper.css('position', '');\n            toolbarHeight = _this.wrapper.outerHeight();\n            _this.editor.placeholderEl.css('top', toolbarHeight);\n            return true;\n          };\n        })(this);\n        floatInitialized = null;\n\n        /*\n        $(window).on('resize.richeditor-' + this.editor.id, function(e) {\n          return floatInitialized = initToolbarFloat();\n        });\n        $(window).on('scroll.richeditor-' + this.editor.id, (function(_this) {\n          return function(e) {\n            var bottomEdge, scrollTop, topEdge;\n            if (!_this.wrapper.is(':visible')) {\n              return;\n            }\n            topEdge = _this.editor.wrapper.offset().top;\n            bottomEdge = topEdge + _this.editor.wrapper.outerHeight() - 80;\n            scrollTop = $(document).scrollTop() + _this.opts.toolbarFloatOffset;\n            if (scrollTop <= topEdge || scrollTop >= bottomEdge) {\n              _this.editor.wrapper.removeClass('toolbar-floating').css('padding-top', '');\n              if (_this.editor.editable.util.os.mobile) {\n                return _this.wrapper.css('top', _this.opts.toolbarFloatOffset);\n              }\n            } else {\n              floatInitialized || (floatInitialized = initToolbarFloat());\n              _this.editor.wrapper.addClass('toolbar-floating').css('padding-top', toolbarHeight);\n              if (_this.editor.editable.util.os.mobile) {\n                return _this.wrapper.css('top', scrollTop - topEdge + _this.opts.toolbarFloatOffset);\n              }\n            }\n          };\n        })(this));\n        */\n      }\n\n      /*\n      this.editor.on('destroy', (function(_this) {\n        return function() {\n          return _this.buttons.length = 0;\n        };\n      })(this));\n      */\n\n      \n    },\n\n    addToolItem : function(itemWidget) {\n      $(itemWidget._elm).appendTo(this.list);\n      return this;\n    },\n\n    addSeparator : function() {\n      $(this.options.separator.template).appendTo(this.list);\n      return this;\n    }\n\n  });\n\n  plugins.register(Toolbar);\n\n  return panels.Toolbar = Toolbar;\n\n});"]}